<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="/css/admin.css">
    <script defer src="/js/admin.js"></script>
</head>
<body>
<div class="background-image"></div>

<div class="admin-panel">

    <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å (–≤–∫–ª–∞–¥–∫–∏) -->
    <aside class="sidebar">
        <ul>
            <li data-tab="users" class="active">
                <span class="icon">üë§</span> –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
            </li>
            <li data-tab="trainers">
                <span class="icon">üèãÔ∏è</span> –í—Å–µ —Ç—Ä–µ–Ω–µ—Ä—ã
            </li>
            <li data-tab="spa-staff">
                <span class="icon">üíÜ</span> –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ SPA
            </li>
            <li data-tab="orders">
                <span class="icon">üõí</span> –í—Å–µ –∑–∞–∫–∞–∑—ã
            </li>
            <li data-tab="training-bookings">
                <span class="icon">üìÖ</span> –ó–∞–ø–∏—Å–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
            </li>
            <li data-tab="spa-bookings">
                <span class="icon">üìÖ</span> –ó–∞–ø–∏—Å–∏ –Ω–∞ —Å–ø–∞
            </li>
            <li data-tab="analysis">
                <span class="icon">üìä</span> –ê–Ω–∞–ª–∏–∑
            </li>
        </ul>
    </aside>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="content">
        <!-- –í–∫–ª–∞–¥–∫–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ -->
        <section id="users" class="tab-content active">
            <h2>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h2>

            <div class="actions">
                <button onclick="clearCache()">–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à Redis</button>
                <button onclick="toggleForm('edit', 'user')">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button onclick="toggleForm('delete', 'user')">–£–¥–∞–ª–∏—Ç—å</button>
            </div>

            <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            <form class="edit-form" id="editUserForm" th:action="@{/user/edit}" method="post">
                <label for="userSelect">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                <select name="userId" id="userSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</option>
                    <option th:each="user : ${users}" th:value="${user.getId()}" th:text="${user.getFirst_name()}"></option>
                </select>
                <label>–ù–æ–≤–æ–µ –∏–º—è: <input type="text" name="firstName" required></label>
                <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </form>

            <!-- –§–æ—Ä–º–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            <form class="delete-form" id="deleteUserForm" th:action="@{/user/delete}" method="post">
                <label for="userDeleteSelect">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:</label>
                <select name="userId" id="userDeleteSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</option>
                    <option th:each="user : ${users}" th:value="${user.getId()}" th:text="${user.getFirst_name()}"></option>
                </select>
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?</p>
                <button type="submit">–£–¥–∞–ª–∏—Ç—å</button>
            </form>

            <div class="search-container">
                <input type="text" id="userSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π..." onkeyup="searchUsers()">
            </div>

            <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
            <div th:each="user : ${users}" class="user-card">
                <p th:text="${user.getFirst_name()}">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
            </div>
        </section>

        <!-- –í–∫–ª–∞–¥–∫–∞ —Å —Ç—Ä–µ–Ω–µ—Ä–∞–º–∏ -->
        <section id="trainers" class="tab-content">
            <h2>–¢—Ä–µ–Ω–µ—Ä—ã</h2>
            <div class="actions">
                <button onclick="toggleForm('edit', 'trainer')">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button onclick="toggleForm('delete', 'trainer')">–£–¥–∞–ª–∏—Ç—å</button>
            </div>

            <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–µ–Ω–µ—Ä–∞ -->
            <form class="edit-form" id="editTrainerForm" th:action="@{/trainer/edit}" method="post">
                <label for="trainerSelect">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–Ω–µ—Ä–∞:</label>
                <select name="trainerId" id="trainerSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–Ω–µ—Ä–∞</option>
                    <option th:each="trainer : ${trainers}" th:value="${trainer.getId()}" th:text="${trainer.getName()}"></option>
                </select>
                <label>–ù–æ–≤–æ–µ –∏–º—è: <input type="text" name="firstName" required></label>
                <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </form>

            <!-- –§–æ—Ä–º–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–µ—Ä–∞ -->
            <form class="delete-form" id="deleteTrainerForm" th:action="@{/trainer/delete}" method="post">
                <label for="trainerDeleteSelect">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–Ω–µ—Ä–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:</label>
                <select name="trainerId" id="trainerDeleteSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–Ω–µ—Ä–∞</option>
                    <option th:each="trainer : ${trainers}" th:value="${trainer.getId()}" th:text="${trainer.getName()}"></option>
                </select>
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Ç—Ä–µ–Ω–µ—Ä–∞?</p>
                <button type="submit">–£–¥–∞–ª–∏—Ç—å</button>
            </form>

            <!-- –°–ø–∏—Å–æ–∫ —Ç—Ä–µ–Ω–µ—Ä–æ–≤ -->
            <div th:each="trainer : ${trainers}" class="card">
                <p th:text="${trainer.getName()}">–ò–º—è —Ç—Ä–µ–Ω–µ—Ä–∞</p>
            </div>
        </section>

        <section id="spa-staff" class="tab-content">
            <h2>–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ SPA</h2>
            <div class="actions">
                <button onclick="toggleForm('edit', 'spaEmployee')">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button onclick="toggleForm('delete', 'spaEmployee')">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
            <form class="edit-form" id="editSpaEmployeeForm" th:action="@{/spaEmployee/edit}" method="post">
                <label for="spaEmployeeSelect">–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ SPA:</label>
                <select name="spaEmployeeId" id="spaEmployeeSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</option>
                    <option th:each="employee : ${spaEmployees}" th:value="${employee.getId()}" th:text="${employee.getName()}"></option>
                </select>
                <label>–ù–æ–≤–æ–µ –∏–º—è: <input type="text" name="name" required></label>
                <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </form>
            <form class="delete-form" id="deleteSpaEmployeeForm" th:action="@{/spaEmployee/delete}" method="post">
                <label for="spaEmployeeDeleteSelect">–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:</label>
                <select name="spaEmployeeId" id="spaEmployeeDeleteSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</option>
                    <option th:each="employee : ${spaEmployees}" th:value="${employee.getId()}" th:text="${employee.getName()}"></option>
                </select>
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞?</p>
                <button type="submit">–£–¥–∞–ª–∏—Ç—å</button>
            </form>
            <div th:each="employee : ${spaEmployees}" class="card">
                <p th:text="${employee.getName()}">–ò–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</p>
            </div>
        </section>

        <!-- –í–∫–ª–∞–¥–∫–∞ —Å –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ -->
        <section id="training-bookings" class="tab-content">
            <h2>–ó–∞–ø–∏—Å–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h2>
            <div class="actions">
                <button onclick="toggleForm('edit', 'trainingBooking')">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button onclick="toggleForm('delete', 'trainingBooking')">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
            <form class="edit-form" id="editTrainingBookingForm" th:action="@{/trainingBooking/edit}" method="post">
                <label for="trainingBookingSelect">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø–∏—Å—å:</label>
                <select name="bookingId" id="trainingBookingSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø–∏—Å—å</option>
                    <option th:each="booking : ${bookings}" th:value="${booking.getId()}" th:text="${#dates.format(booking.getDate(), 'yyyy-MM-dd')} +' '+  ${#temporals.format(booking.getTime(), 'HH:mm')}"></option>
                </select>
                <label>–ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å: <input type="text" name="status" required></label>
                <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </form>
            <form class="delete-form" id="deleteTrainingBookingForm" th:action="@{/trainingBooking/delete}" method="post">
                <label for="trainingBookingDeleteSelect">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø–∏—Å—å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:</label>
                <select name="bookingId" id="trainingBookingDeleteSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø–∏—Å—å</option>
                    <option th:each="booking : ${bookings}" th:value="${booking.getId()}" th:text="${#dates.format(booking.getDate(), 'yyyy-MM-dd')}+' '+ ${#temporals.format(booking.getTime(), 'HH:mm')}"></option>
                </select>
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å?</p>
                <button type="submit">–£–¥–∞–ª–∏—Ç—å</button>
            </form>

            <div class="search-container">
                <input type="text" id="trainingSearch" placeholder="–ü–æ–∏—Å–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫..." onkeyup="searchTrainings()">
                <select id="searchCategory">
                    <option value="time">–ü–æ –≤—Ä–µ–º–µ–Ω–∏</option>
                    <option value="date">–ü–æ –¥–∞—Ç–µ</option>
                    <option value="status">–ü–æ –°—Ç–∞—Ç—É—Å—É</option>
                    <option value="user_employee">–ü–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É</option>
                </select>
            </div>


            <div th:each="booking : ${bookings}" class="training-card">
                <p th:text="${#dates.format(booking.getDate(), 'yyyy-MM-dd')}"></p>
                <p th:text="${#temporals.format(booking.getTime(), 'HH:mm')}"></p>
                <p th:text="${booking.getStatus()}">–°—Ç–∞—Ç—É—Å</p>
                <p th:text="'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ' + ${booking.getUserUsername()} + ', –¢—Ä–µ–Ω–µ—Ä: ' + ${booking.getTrainerUsername()}"></p>
            </div>
        </section>

        <!-- –í–∫–ª–∞–¥–∫–∞ —Å –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ SPA -->
        <section id="spa-bookings" class="tab-content">
            <h2>–ó–∞–ø–∏—Å–∏ –Ω–∞ SPA</h2>
            <div class="actions">
                <button onclick="toggleForm('edit', 'spaBooking')">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button onclick="toggleForm('delete', 'spaBooking')">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
            <form class="edit-form" id="editSpaBookingForm" th:action="@{/spaBooking/edit}" method="post">
                <label for="spaBookingSelect">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø–∏—Å—å:</label>
                <select name="bookingId" id="spaBookingSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø–∏—Å—å</option>
                    <option th:each="booking : ${spaBookings}" th:value="${booking.getId()}" th:text="${#dates.format(booking.getDate(), 'yyyy-MM-dd')} +' '+${#temporals.format(booking.getTime(), 'HH:mm')}"></option>
                </select>
                <label>–ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å: <input type="text" name="status" required></label>
                <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </form>
            <form class="delete-form" id="deleteSpaBookingForm" th:action="@{/spaBooking/delete}" method="post">
                <label for="spaBookingDeleteSelect">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø–∏—Å—å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:</label>
                <select name="bookingId" id="spaBookingDeleteSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø–∏—Å—å</option>
                    <option th:each="booking : ${spaBookings}" th:value="${booking.getId()}" th:text="${#dates.format(booking.getDate(), 'yyyy-MM-dd')} +' '+${#temporals.format(booking.getTime(), 'HH:mm')}"></option>
                </select>
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å?</p>
                <button type="submit">–£–¥–∞–ª–∏—Ç—å</button>
            </form>

            <div class="search-container">
                <input type="text" id="spaSearch" placeholder="–ü–æ–∏—Å–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫..." onkeyup="searchSpa()">
                <select id="searchSpaCategory">
                    <option value="time">–ü–æ –≤—Ä–µ–º–µ–Ω–∏</option>
                    <option value="date">–ü–æ –¥–∞—Ç–µ</option>
                    <option value="status">–ü–æ –°—Ç–∞—Ç—É—Å—É</option>
                    <option value="user_employee">–ü–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É</option>
                </select>
            </div>


            <div th:each="booking : ${spaBookings}" class="spa-card">
                <p th:text="${#dates.format(booking.getDate(), 'yyyy-MM-dd')}"></p>
                <p th:text="${#temporals.format(booking.getTime(), 'HH:mm')}"></p>
                <p th:text="${booking.getStatus()}">–°—Ç–∞—Ç—É—Å</p>
                <p th:text="'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ' + ${booking.getUser.getUsername()} + ', –°–æ—Ç—Ä—É–¥–Ω–∏–∫: ' + ${booking.getEmployeeName()}"></p>

            </div>
        </section>

        <!-- –í–∫–ª–∞–¥–∫–∞ —Å –∑–∞–∫–∞–∑–∞–º–∏ -->
        <section id="orders" class="tab-content">
            <h2>–ó–∞–∫–∞–∑—ã</h2>
            <div class="actions">
                <button onclick="toggleForm('edit', 'order')">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button onclick="toggleForm('delete', 'order')">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
            <form class="edit-form" id="editOrderForm" th:action="@{/order/edit}" method="post">
                <label for="orderSelect">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–∫–∞–∑:</label>
                <select name="orderId" id="orderSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–∫–∞–∑</option>
                    <option th:each="order : ${orders}" th:value="${order.getOrderId()}" th:text="${order.getOrderId()} +' '+${order.getStatus()}"></option>
                </select>
                <label>–ù–æ–≤—ã–µ –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞: <input type="text" name="newDetails" required></label>
                <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </form>
            <form class="delete-form" id="deleteOrderForm" th:action="@{/order/delete}" method="post">
                <label for="orderDeleteSelect">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–∫–∞–∑ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:</label>
                <select name="orderId" id="orderDeleteSelect" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–∫–∞–∑</option>
                    <option th:each="order : ${orders}" th:value="${order.getOrderId()}" th:text="${order.getOrderId()} +' '+ ${order.getStatus()}"></option>
                </select>
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑?</p>
                <button type="submit">–£–¥–∞–ª–∏—Ç—å</button>
            </form>

            <div class="search-container">
                <input type="text" id="orderSearch" placeholder="–ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–æ–≤ –ø–æ ID..." onkeyup="searchOrders()">
            </div>
            <div th:each="order : ${orders}" class="order-card">
                <p th:text="${order.getOrderId() + ' ' + order.getStatus() + ' ' + order.getUserName()  + ' ' + order.getTotalPrice()}">–°—Ç–∞—Ç—É—Å</p>
                <div th:each="product:${order.getProducts()}">
                    <p th:text ="${product.getName()}"></p>
                </div>
            </div>
        </section>

        <!-- –í–∫–ª–∞–¥–∫–∞ —Å –∞–Ω–∞–ª–∏–∑–æ–º -->
        <section id="analysis" class="tab-content">
            <h2>–ê–Ω–∞–ª–∏–∑</h2>
            <!-- –§–æ—Ä–º–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö -->
            <form id="export-form" class="export-form" action="/analysis/export" method="get">
                <div>
                    <label for="data-type">–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞:</label>
                    <select id="data-type" name="exportType" required>
                        <option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö</option>
                        <option value="users-export">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</option>
                        <option value="orders-export">–ó–∞–∫–∞–∑—ã</option>
                        <option value="bookings-export">–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</option>
                        <option value="spa-bookings-export">SPA –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</option>
                    </select>
                </div>
                <button type="submit">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
            </form>

            <!-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã -->
            <div class="popular-section">
                <h3>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã</h3>
                <div class="popular-grid">
                    <!-- –ü–æ–ø—É–ª—è—Ä–Ω–æ–µ –≤—Ä–µ–º—è -->
                    <div class="card">
                        <h3>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∞</h3>
                        <ul>
                            <th:block th:each="time : ${popularTimes}">
                                <li th:text="${time.time} + ' ‚Äî ' + ${time.count}"></li>
                            </th:block>
                        </ul>
                    </div>

                    <!-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç—Ä–µ–Ω–µ—Ä—ã -->
                    <div class="card">
                        <h3>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç—Ä–µ–Ω–µ—Ä—ã</h3>
                        <ul>
                            <th:block th:each="trainer : ${popularTrainers}">
                                <li th:text="${trainer.trainerName} + ' ‚Äî ' + ${trainer.count}"></li>
                            </th:block>
                        </ul>
                    </div>

                    <!-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ SPA -->
                    <div class="card">
                        <h3>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ SPA</h3>
                        <ul>
                            <th:block th:each="spaEmployee : ${popularSpaEmployees}">
                                <li th:text="${spaEmployee.name} + ' ‚Äî ' + ${spaEmployee.count}"></li>
                            </th:block>
                        </ul>
                    </div>

                    <!-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã -->
                    <div class="card">
                        <h3>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã</h3>
                        <ul>
                            <th:block th:each="product : ${popularProducts}">
                                <li th:text="${product.productName} + ' ‚Äî ' + ${product.count}"></li>
                            </th:block>
                        </ul>
                    </div>
                </div>
            </div>
        </section>



    </main>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        const tabs = document.querySelectorAll('.sidebar li');
        const tabContents = document.querySelectorAll('.tab-content');

        tabs.forEach(tab => {
            tab.addEventListener('click', function () {
                // –£–¥–∞–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(content => content.classList.remove('active'));

                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å
                tab.classList.add('active');
                const targetTab = document.getElementById(tab.getAttribute('data-tab'));
                if (targetTab) targetTab.classList.add('active');
            });
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–≤–æ–π –≤–∫–ª–∞–¥–∫–∏
        const initialTab = document.querySelector('.sidebar li.active');
        if (initialTab) initialTab.click();

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã —ç–∫—Å–ø–æ—Ä—Ç–∞
        const exportForm = document.getElementById("export-form");
        if (exportForm) {
            exportForm.addEventListener("submit", (e) => {
                e.preventDefault();

                // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö
                const dataType = document.getElementById("data-type").value;

                if (!dataType) {
                    alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞.");
                    return;
                }

                // –§–æ—Ä–º–∏—Ä—É–µ–º URL –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
                const exportUrl = `/analysis/export?exportTypes=${dataType}`;

                // –í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                fetch(exportUrl, { method: 'GET' })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error("–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: " + response.statusText);
                        }
                        return response.blob();
                    })
                    .then(blob => {
                        // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
                        const url = window.URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.href = url;
                        link.download = `${dataType}-export.xlsx`; // –ò–º—è —Ñ–∞–π–ª–∞
                        link.click();
                        window.URL.revokeObjectURL(url);
                    })
                    .catch(error => {
                        console.error('–û—à–∏–±–∫–∞:', error);
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –¥–∞–Ω–Ω—ã—Ö: ' + error.message);
                    });
            });
        }
    });
</script>

</body>
</html>